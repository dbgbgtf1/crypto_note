diffie-hellman是一种协商密钥的协议，利用离散对数求解困难来保证私钥不泄露

## 原根概念

设g是p的原根，则
`g^1 mod p`, `g^2 mod p`, ... `g^(p-1) mod p`能构成所有不为0的模p元素
即`1, 2, ... p-1`

## 交换密钥过程

共同协商一个素数p, 再协商一个p的原根g
p, g公开，可以直接在不安全信道通信

Alice随机选取私钥 a 属于 {1, 2, ... p-2}
计算Alice的公钥A = g^a mod p，发送给Bob

Bob随机选取私钥 b 属于 {1, 2, ... p-2}
计算Bob的公钥B = g^b mod p, 发送给Alice

a不公开，A可以公开
由于离散对数求解困难，很难从A推出a，B同理

Alice收到B, 计算共享密钥pub = B^a mod p
Bob收到A, 计算共享密钥pub = A^b mod p
并且共享密钥不公开

## 安全性分析

此时假设有中间人监听，得到了g, p, A, B
计算a, b, 或是g^(ab)依然很困难, 所以中间人无法破解加密消息或是密钥

但是假设中间人有劫持篡改信息的能力，这种协商方式依然不安全
可能存在Alice和Bob实际上一直在和中间人协商密钥的可能性，也就是无法验证身份
